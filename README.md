# TestTaskMonitel

## Общие особенности реализации
- Реализован весь обязательный функционал, описанный в ТЗ.
- Для основной части бизнес логики (в частности планирование расписания показов) написаны Unit-тесты с использованием ```XUnit``` и ```FluentAssertions```
- Сохранение постеров фильма происходит в Minio (получение постера из хранилища не реализовано).
- Параллельный доступ к изменению бизнес-агрегатов ограничен с помощью оптимистичной блокировки.
- Инфраструктурные зависимости вынесены в Docker.
- Для удобства проверки задания при запуске приложения в Dev режиме БД заполняется тестовыми данными.
- В решении сознательно опущен паттерн Repository для удобства разработки и более ясного кода.
- Для удобства тестирования добавлен Swagger.

## Структура проекта
- **Solution Items**: Вспомогательные файлы для проекта (конфигурации, docker файлы, etc...).
- **src** - Проекты и решения с основной логикой
  - **Infrastructure**
    - **Main.DAL.Database** - Конфигурации EF сущностей, миграции и т.д.
    - **Main.DAL.Minio** - Работа с файловым хранилищем (в реализации Minio).
  - **Main.Application** - Проект для объединения бизнес логики и инфраструктурных зависимостей.
  - **Main.Domain** - Проект, в котором сосредоточена основная бизнес логика.
  - **Main.WebApi** - Проект, содержащий всю необходимую логику для запуска сервиса и предоставления REST Api.
- **Tests** - Тесты  
                             
## Запуск проекта c Docker

### Шаг 1. Клонирование проекта
```bash
git clone https://github.com/KonstantinPolyanskiy/TestTaskMonitel.git
```

### Шаг 2. Запуск инфраструктурных docker образов

```bash
cd TestTaskMonitel && docker compose up
```

### Шаг 3. Создать и применить миграции

```bash
cd Main.WebApi && dotnet ef migrations add InitialMigration --project ../Main.DAL.Database --startup-project . --output-dir Migrations && dotnet ef database update --project ../Main.DAL.Database --startup-project .
```

### Шаг 4. Запуск проекта 

```bash
dotnet run
```

### Шаг 5. Открыть Swagger страницу
```bash
http://localhost:<port>/swagger/index.html
```
